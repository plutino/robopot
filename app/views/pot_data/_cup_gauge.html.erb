<%= javascript_tag do %>
    google.load('visualization', '1', {packages:['gauge']});
    google.setOnLoadCallback(get_level);
    setInterval(get_level, 2000);

    function drawGauge(level) {
        var data = google.visualization.arrayToDataTable([
            ['Label', 'Value'],
            ['Cups Left', level]
        ]);

        var options = {
            width: 500,
            height: 500,
            animation: {duration: 400, easing: 'inAndOut'},
            majorTicks: ['0',2,4,6,8,10],
            minorTicks: 2,
            min: 0,
            max: 1000,
            redFrom: 0,
            redTo: 2,
            yellowFrom: 2,
            yellowTo: 8,
            greenFrom: 8,
            greenTo: 10
        };

        var chart = new google.visualization.Gauge(document.getElementById('gauge_div'));
        chart.draw(data, options);
    }

    function get_level(){
        jQuery.get("/get_level", function(level_hash) {
           console.log(level_hash.level);
           drawGauge(level_hash.level);
        });
    };

<% end %>

<td id='gauge_div' />
